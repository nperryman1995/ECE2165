/*
 * zscore_driver.c
 *
 *  Created on: Nov 19, 2018
 *      Author: Mitch
 */

#include "zscore_driver.h"

#define ZSCORE_MEAN_INDEX 0
#define ZSCORE_COUNT_INDEX 1
#define ZSCORE_STDDEV_INDEX 2
#define ZSCORE_DATA_START_INDEX 3


void Zscore_setup(Zscore_Control_t *Zscore_settings, u32 * zscore_baseaddr, u32 zscore_data_spots){
	Zscore_settings->zscore_baseaddr = zscore_baseaddr;
	Zscore_settings->zscore_data_spots = zscore_data_spots;
	Zscore_settings->zscore_data_index = 0;
}
void Zscore_addData(Zscore_Control_t *Zscore_settings, u32 data){
	*(Zscore_settings->zscore_baseaddr + ZSCORE_DATA_START_INDEX + Zscore_settings->zscore_data_index) = data;
	Zscore_settings->zscore_data_index++;
	if(Zscore_settings->zscore_data_index >= Zscore_settings->zscore_data_spots){
		Zscore_settings->zscore_data_index = 0;
	}
}
u32 Zscore_getStandardDev(Zscore_Control_t *Zscore_settings){
	return *(Zscore_settings->zscore_baseaddr + ZSCORE_STDDEV_INDEX);
}
u32 Zscore_checkAnomaly(Zscore_Control_t *Zscore_settings, u32 threshold){
	if(Zscore_getStandardDev(Zscore_settings) > threshold){
		return 1;
	}
	return 0;
}


